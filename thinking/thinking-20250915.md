
[[2025-10-28 16:29]]


整理结构化、半结构化数据类型、解析方案


## 已有技术路线


| 技术路线      | 缺点                | 产品       |
| --------- | ----------------- | -------- |
| NL2SQL    | 先转换成结构化表，但部分数据会丢失 |          |
| NL2Pandas | 先转换成结构化表          | pandasai |



## 数据类型

| 布局              | 图示                                                                                                           |
| --------------- | ------------------------------------------------------------------------------------------------------------ |
| 1. 常规单表头        | ![[Pasted image 20251028163655.png]]                                                                         |
| 1.2 常规单表头-数据带合并 | ![[Pasted image 20251028164139.png]]![[Pasted image 20251028165241.png]]                                     |
| 2. 1 合并横向表头     | ![[Pasted image 20251028163626.png]]![[Pasted image 20251028163948.png]]![[Pasted image 20251028165140.png]] |
| 2.2 合并横向表头-带说明  | ![[Pasted image 20251028164614.png]]![[Pasted image 20251028164702.png]]                                     |
| 3. 纵向多表         | ![[4e139270-9a88-45b1-af77-b142ac4dec8b.png]]![[Pasted image 20251028170555.png]]                            |
| 4. 横向多表         | ![[Pasted image 20251028164359.png]]![[Pasted image 20251028164445.png]]                                     |
| 5. 无规范表头        | ![[Pasted image 20251028170315.png]]                                                                         |
| 6. 其他制式 - 合同    | ![[Pasted image 20251028170859.png]]![[Pasted image 20251028170923.png]]![[Pasted image 20251028170935.png]] |





存储：
csv
sql
json
duckDB

## 方案
1. 基于当前方案识别表头索引行，进一步提取
2. excel 通过libreoffice（外挂服务） 转换成html， 再转换成pdf，使用minerU(需要测评上述数据所有情况，极端情况：数据量特别大的情况)【问题： minerU存储markdown，转换markdown后如何用于问答？应该走什么方式？】

3. st-raptor(存储为树形结构)

目的： 提取表头，存储为表头数据表。
1. 获取pdf第一页，走视觉模型，提取到表头信息，存储到sql

先编写一个excel -> pdf 的脚本用于测试



## 评测：
1. 服务

st-raptor:

http://192.168.30.69:7860/
192.168.30.69
root 密码：T9k!qW@7rF$3xYp&
/data/projects/ST-Raptor
tail -n 1000 -f excel.log

minerU:
http://10.8.0.77:18000/docs

