
[[2025-10-28 16:29]]


整理结构化、半结构化表头提取、解析方案


## 已有技术路线


| 技术路线      | 缺点                | 产品       |
| --------- | ----------------- | -------- |
| NL2SQL    | 先转换成结构化表，但部分数据会丢失 |          |
| NL2Pandas | 先转换成结构化表          | pandasai |



## 数据类型

| 布局              | 图示                                                                                                           |
| --------------- | ------------------------------------------------------------------------------------------------------------ |
| 1. 常规单表头        | ![[Pasted image 20251028163655.png]]                                                                         |
| 1.2 常规单表头-数据带合并 | ![[Pasted image 20251028164139.png]]![[Pasted image 20251028165241.png]]                                     |
| 2. 1 合并横向表头     | ![[Pasted image 20251028163626.png]]![[Pasted image 20251028163948.png]]![[Pasted image 20251028165140.png]] |
| 2.2 合并横向表头-带说明  | ![[Pasted image 20251028164614.png]]![[Pasted image 20251028164702.png]]                                     |
| 3. 纵向多表         | ![[4e139270-9a88-45b1-af77-b142ac4dec8b.png]]![[Pasted image 20251028170555.png]]                            |
| 4. 横向多表         | ![[Pasted image 20251028164359.png]]![[Pasted image 20251028164445.png]]                                     |
| 5. 无规范表头        | ![[Pasted image 20251028170315.png]]                                                                         |
| 6. 其他制式 - 合同    | ![[Pasted image 20251028170859.png]]![[Pasted image 20251028170923.png]]![[Pasted image 20251028170935.png]] |





存储：
csv
sql
json
duckDB

## 方案

1. 基于当前方案识别表头索引行，进一步提取
2. excel 通过libreoffice（外挂服务） 转换成html， 再转换成pdf，使用minerU(需要测评上述数据所有情况，极端情况：数据量特别大的情况)【问题： minerU存储markdown，转换markdown后如何用于问答？应该走什么方式？】

3. st-raptor(存储为树形结构) 解析速度比较慢，且不稳定，多种excel存在解析失败的问题(未定位问题是否模型导致)

提取表头：
1. 转换为pdf，获取pdf第一页，vlm提取表头信息，存储到sql (表头说明表)【❌会出现幻觉，且结构化依赖模型能力】
2. 模型获取行索引，将行索引前的所有文本输入到模型中结构话提取，存储到sql (表头说明表)
3. st-raptor: 如果数据量特别大，是否会影响性能？ 【解析效果会有影响、表格不规范会出现解析失败】
4. st-raptor： 用于提取表头


## 评测：

### 用例一： Eco

原始数据
![[Pasted image 20251029161322.png]]

截取局部数据
![[Pasted image 20251029161352.png]]


ST-Raptor
![[48653675-2929-4eb0-9b6a-3382e89493fe.png]]


minerU 线上
![[Pasted image 20251029161659.png]]
![[Pasted image 20251029161711.png]]

![[Pasted image 20251029162421.png]]

minerU 私有部署
```
<table><tr><td colspan=\"2\">TES</td><td colspan=\"4\">■ENGINEERING/□PROTOTYPE CHANGE ORDER</td><td colspan=\"2\">Model Name:</td><td colspan=\"9\">JFS-15</td></tr><tr><td colspan=\"2\" rowspan=\"2\">SYMBOL: A</td><td rowspan=\"2\">CHANGE</td><td colspan=\"2\"></td><td rowspan=\"2\">=</td><td colspan=\"2\"></td><td colspan=\"9\">Dispositon: C = Cancel, K = Keep, R = Rework, RS = Re-sell, RTV = Return To Vendor, SB = Substitution,</td></tr><tr><td>A</td><td>ADD</td><td>DELETE</td><td>DESCRIPTION /</td><td></td><td>SC = Scrap Unit</td><td>Status</td><td>Vendor</td><td>Open</td><td>In</td><td>Stock</td><td>WIP</td><td>Finish</td><td>F/G</td></tr><tr><td>NO</td><td colspan=\"2\">ASSY PART NO.</td><td>SY</td><td>ID Loc.</td><td>PART NO.</td><td>SPECIFICATION</td><td>Q&#x27;TYOR</td><td>Cost</td><td></td><td>Stock</td><td></td><td>PO</td><td>Route</td><td></td><td></td><td>Goods</td><td>In Route</td></tr></table>
```

![[Pasted image 20251029161551.png]]



## note

st-raptor:

http://192.168.30.69:7860/
192.168.30.69
root 密码：T9k!qW@7rF$3xYp&
/data/projects/ST-Raptor
tail -n 1000 -f excel.log

minerU:
http://10.8.0.77:18000/docs

